# Screen Capture Mirror v3

ブラウザ上でOSの全画面をミラーリングし、ブラウザからのクリック操作とキー入力を低遅延で転送するリモート操作ツール。

# 構成ツール
- **マニピュレータ (`index.html`)**
- **イベントテスタ (`ev-tester.html`)**

# マニピュレータ
- `navigator.mediaDevices.getDisplayMedia` を使用してOS全画面を投影。
- `displaySurface: monitor` を優先し、全画面モードに最適化。
- インテリジェント・ターゲット特定: クリック位置から操作対象のウィンドウを自動特定。
- マウス座標表示: マウス位置に絶対ピクセル座標を表示
- 操作ログ表示:
  - 画面右下に表示 
  - マウス操作イベント、キー操作イベント表示

# イベントテスタ
リモート操作の精度と入力を検証するための専用画面。
- **クリック視覚化**: 最新のクリック位置に十字マーカーを表示。
- **ステータス表示**: 現在フォーカスされている要素のID、値、およびマウスの絶対座標をリアルタイム表示。
- **イベントログ**: キー・マウスイベント、フォーカス切り替えイベントを履歴として出力。

# セットアップと実行

1.  **依存関係のインストール**:
    ```bash
    npm install
    ```

2.  **サーバーの起動**:
    ```bash
    node server.js -p <port>
    ```
    - port: デフォルト3003

3.  **ブラウザでアクセス**:
    - 操作画面: `http://localhost:3003`
    - 検証画面: `http://localhost:3003/ev-tester.html`

4.  **サーバーの終了**:
    ブラウザで `http://localhost:3003/close` にアクセス。

# AI指示
- テスト開始時にss(スクリーンショット)取得し、操作後のssと比較すること。
- Playwrightのテストでマニピュレータを起動している場合、ユーザ操作はページ遷移禁止、クリックとキー入力のみとする。
- **停止のためのプロセスkillは絶対禁止!!** (AI自殺防止のため)
- 動作の確認は必ず画面キャプチャで行う。ただし自身のプログラムで出力したログは信用しない。