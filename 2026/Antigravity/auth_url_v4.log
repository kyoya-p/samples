--- Starting Sheets API Test ---
Current Working Directory: C:\Users\kyoya\works\samples\2026\Antigravity
1. Creating a test spreadsheet...
Registering protocol with command: "C:\Users\kyoya\AppData\Local\mise\installs\java\21.0.2\bin\java.exe" -cp "C:\Users\kyoya\works\samples\2026\Antigravity\build\libs\Antigravity-0.0.1.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\org.jetbrains.compose.desktop\desktop-jvm\1.6.1\4c88c77f0770ee2c111199047d90ed5a47e4482b\desktop-jvm-1.6.1.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\org.jetbrains.skiko\skiko-awt-runtime-windows-x64\0.7.97\70e5ac402b2f402458dcc6f5ac6fc058157201fd\skiko-awt-runtime-windows-x64-0.7.97.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\org.jetbrains.compose.material\material-desktop\1.6.1\8aba1d1e6fb631404f8e227b8da35a7599add83\material-desktop-1.6.1.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\org.jetbrains.compose.material\material-ripple-desktop\1.6.1\211b0740ee3291b32ee3ed9dc224f8b526fe5923\material-ripple-desktop-1.6.1.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\org.jetbrains.compose.foundation\foundation-desktop\1.6.1\dd8d1c508d30ccad143d683c52b391be457c25ee\foundation-desktop-1.6.1.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\org.jetbrains.compose.animation\animation-desktop\1.6.1\e0e0918c035bd28c2cf3a02c2ebc092880d38a43\animation-desktop-1.6.1.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\org.jetbrains.compose.foundation\foundation-layout-desktop\1.6.1\9d639e56f127b36e0a2889af30b534ef713717d5\foundation-layout-desktop-1.6.1.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\org.jetbrains.compose.animation\animation-core-desktop\1.6.1\3c6651ae9363fcb4a80dcdd564b2ae2e6ead54e5\animation-core-desktop-1.6.1.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\org.jetbrains.compose.material\material-icons-core-desktop\1.6.1\47e99680d4e5f234dc4514fd12fec4daf1af4597\material-icons-core-desktop-1.6.1.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\org.jetbrains.compose.ui\ui-desktop\1.6.1\6d22611f44d8ae6c66f6e76506dcb9cc5bc4edfe\ui-desktop-1.6.1.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\org.jetbrains.compose.ui\ui-text-desktop\1.6.1\ce3a7f60351c781cd0afe9c965d88862dfae59cd\ui-text-desktop-1.6.1.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\org.jetbrains.compose.ui\ui-graphics-desktop\1.6.1\9e80f1f2e3104ef38e6e274576c8162bd9854afe\ui-graphics-desktop-1.6.1.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\org.jetbrains.skiko\skiko-awt\0.7.97\90aad197125592a9a8f1b1da8fbd6e915059a0af\skiko-awt-0.7.97.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\org.jetbrains.compose.ui\ui-tooling-preview-desktop\1.6.1\62232c44c61692b56d3071c29b0f9c8481b20574\ui-tooling-preview-desktop-1.6.1.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\org.jetbrains.compose.runtime\runtime-saveable-desktop\1.6.1\1b72e4ff3c9e4940a90001c93a3108725e90dc34\runtime-saveable-desktop-1.6.1.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\org.jetbrains.compose.ui\ui-unit-desktop\1.6.1\6489dd3c2b6122e1ebba9e9c1081779dc4e125ee\ui-unit-desktop-1.6.1.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\org.jetbrains.compose.ui\ui-geometry-desktop\1.6.1\7eae6ed5c40e7e61eb16c2c7edfbd2019f2c239d\ui-geometry-desktop-1.6.1.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\org.jetbrains.compose.runtime\runtime-desktop\1.6.1\6b2d136b5e5d4295cbb4256fadd71e15bea79539\runtime-desktop-1.6.1.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\org.jetbrains.compose.ui\ui-util-desktop\1.6.1\18d22abacf8b0224d12548b03352c810b71a6f42\ui-util-desktop-1.6.1.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\org.jetbrains.kotlin\kotlin-stdlib-jdk8\1.9.23\557350a0941ddfe919fd2a30d996355bebc8a3a3\kotlin-stdlib-jdk8-1.9.23.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\org.jetbrains.kotlinx\kotlinx-coroutines-core-jvm\1.8.0\ac1dc37a30a93150b704022f8d895ee1bd3a36b3\kotlinx-coroutines-core-jvm-1.8.0.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\org.jetbrains.kotlin\kotlin-stdlib-jdk7\1.9.23\b8eca9abec56bee1d01c788e3d571114416ea56d\kotlin-stdlib-jdk7-1.9.23.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\org.jetbrains.kotlinx\atomicfu-jvm\0.23.2\a4601dc42dceb031a586058e8356ff778a57dea0\atomicfu-jvm-0.23.2.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\androidx.collection\collection-jvm\1.4.0\e209fb7bd1183032f55a0408121c6251a81acb49\collection-jvm-1.4.0.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\androidx.annotation\annotation-jvm\1.7.1\920472d40adcdef5e18708976b3e314f9a636fcd\annotation-jvm-1.7.1.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\org.jetbrains.kotlin\kotlin-stdlib\1.9.23\dbaadea1f5e68f790d242a91a38355a83ec38747\kotlin-stdlib-1.9.23.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\com.google.apis\google-api-services-sheets\v4-rev20220927-2.0.0\742ffca984c77e5dd33a688336917b93a7bdac2d\google-api-services-sheets-v4-rev20220927-2.0.0.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\com.google.api-client\google-api-client\2.2.0\10e53fd4d987e37190432e896bdaa62e8ea2c628\google-api-client-2.2.0.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\com.google.oauth-client\google-oauth-client-jetty\1.34.1\a6aff2c1be148bac622e5048e20f536f71b3380d\google-oauth-client-jetty-1.34.1.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\org.jetbrains\annotations\23.0.0\8cc20c07506ec18e0834947b84a864bfc094484e\annotations-23.0.0.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\com.google.http-client\google-http-client-apache-v2\1.42.3\3dc8cea436c52d0d248abe9648b0e4f1d02bd500\google-http-client-apache-v2-1.42.3.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\com.google.oauth-client\google-oauth-client-java6\1.34.1\af6b85ed729e96a5257741986e823aa241f3d9a4\google-oauth-client-java6-1.34.1.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\com.google.oauth-client\google-oauth-client\1.34.1\4a4f88c5e13143f882268c98239fb85c3b2c6cb2\google-oauth-client-1.34.1.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\com.google.http-client\google-http-client-gson\1.42.3\3251b36ee9e9c3effe3293f8d7094aa3841cad55\google-http-client-gson-1.42.3.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\com.google.http-client\google-http-client\1.42.3\e0feb1bd93ad9fb1e064706cff96e32b41a57b9c\google-http-client-1.42.3.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\org.apache.httpcomponents\httpclient\4.5.14\1194890e6f56ec29177673f2f12d0b8e627dec98\httpclient-4.5.14.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\commons-codec\commons-codec\1.15\49d94806b6e3dc933dacbd8acb0fdbab8ebd1e5d\commons-codec-1.15.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\io.opencensus\opencensus-contrib-http-util\0.31.1\3c13fc5715231fadb16a9b74a44d9d59c460cfa8\opencensus-contrib-http-util-0.31.1.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\com.google.guava\guava\31.1-jre\60458f877d055d0c9114d9e1a2efb737b4bc282c\guava-31.1-jre.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\org.apache.httpcomponents\httpcore\4.4.16\51cf043c87253c9f58b539c9f7e44c8894223850\httpcore-4.4.16.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\com.google.code.gson\gson\2.10\dd9b193aef96e973d5a11ab13cd17430c2e4306b\gson-2.10.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\com.google.guava\failureaccess\1.0.1\1dcf1de382a0bf95a3d8b0849546c88bac1292c9\failureaccess-1.0.1.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\com.google.guava\listenablefuture\9999.0-empty-to-avoid-conflict-with-guava\b421526c5f297295adef1c886e5246c39d4ac629\listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\com.google.code.findbugs\jsr305\3.0.2\25ea2e8b0c338a877313bd4672d3fe056ea78f0d\jsr305-3.0.2.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\org.checkerframework\checker-qual\3.12.0\d5692f0526415fcc6de94bb5bfbd3afd9dd3b3e5\checker-qual-3.12.0.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\com.google.errorprone\error_prone_annotations\2.16\3fdb501b45ba22c6e9c0f2abdb6ed747a48c71af\error_prone_annotations-2.16.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\com.google.j2objc\j2objc-annotations\1.3\ba035118bc8bac37d7eff77700720999acd9986d\j2objc-annotations-1.3.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\commons-logging\commons-logging\1.2\4bfc12adfe4842bf07b657f0369c4cb522955686\commons-logging-1.2.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\io.opencensus\opencensus-api\0.31.1\66a60c7201c2b8b20ce495f0295b32bb0ccbbc57\opencensus-api-0.31.1.jar;C:\Users\kyoya\.gradle\caches\modules-2\files-2.1\io.grpc\grpc-context\1.27.2\1789190601b7a5361e4fa52b6bc95ec2cd71e854\grpc-context-1.27.2.jar" com.example.MainKt "%1"
Successfully registered protocol in registry.
Please open this URL: https://accounts.google.com/o/oauth2/v2/auth?client_id=307495712434-ueklearfqoqp1u4657fk550pj49odfet.apps.googleusercontent.com&redirect_uri=com.googleusercontent.apps.307495712434-ueklearfqoqp1u4657fk550pj49odfet%3A%2Foauth2callback&response_type=code&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fspreadsheets+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.file&code_challenge=s0arN7Oc7YLpnOFXeZu9Q7Q-mzsk7IZFpglA81_yvWs&code_challenge_method=S256&access_type=offline
Waiting for authorization code from browser (custom scheme redirect)...
If the browser fails to redirect, you can manually paste the 'code' parameter here:
Exception in thread "main" java.lang.Exception: Authorization timed out or failed.
	at com.example.GoogleSheetsService.authorizeManual(GoogleSheetsService.kt:161)
	at com.example.GoogleSheetsService.getService(GoogleSheetsService.kt:189)
	at com.example.GoogleSheetsService.createSpreadsheet(GoogleSheetsService.kt:198)
	at com.example.TestSessionKt$main$1.invokeSuspend(TestSession.kt:13)
	at kotlin.coroutines.jvm.internal.BaseContinuationImpl.resumeWith(ContinuationImpl.kt:33)
	at kotlinx.coroutines.DispatchedTask.run(DispatchedTask.kt:104)
	at kotlinx.coroutines.EventLoopImplBase.processNextEvent(EventLoop.common.kt:277)
	at kotlinx.coroutines.BlockingCoroutine.joinBlocking(Builders.kt:95)
	at kotlinx.coroutines.BuildersKt__BuildersKt.runBlocking(Builders.kt:69)
	at kotlinx.coroutines.BuildersKt.runBlocking(Unknown Source)
	at kotlinx.coroutines.BuildersKt__BuildersKt.runBlocking$default(Builders.kt:48)
	at kotlinx.coroutines.BuildersKt.runBlocking$default(Unknown Source)
	at com.example.TestSessionKt.main(TestSession.kt:5)

FAILURE: Build failed with an exception.

* What went wrong:
Execution failed for task ':run'.
> Process 'command 'C:\Users\kyoya\AppData\Local\mise\installs\java\21.0.2\bin\java.exe'' finished with non-zero exit value 1

* Try:
> Run with --stacktrace option to get the stack trace.
> Run with --info or --debug option to get more log output.
> Run with --scan to get full insights.
> Get more help at https://help.gradle.org.

BUILD FAILED in 10m 6s
