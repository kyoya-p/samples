<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SheetMaster | Google Sheets API Manager</title>
    <meta name="description" content="Google Sheets APIを使用したスプレッドシート作成・操作アプリケーション。">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Outfit:wght@300;500;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <!-- Google APIs (Client Library and GSI) -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="https://apis.google.com/js/api.js" async defer></script>
</head>

<body>
    <div class="background-canvas"></div>

    <main class="glass-container">
        <header class="app-header">
            <h1 class="app-title">SheetMaster</h1>
            <p class="app-subtitle">API-driven Spreadsheet Management</p>
        </header>

        <!-- Configuration Step -->
        <section id="config-section" class="glass-card config-panel">
            <h2>1. Configuration</h2>
            <div class="input-stack">
                <input type="text" id="input-client-id"
                    placeholder="Google Client ID (xxxx.apps.googleusercontent.com)">
                <input type="text" id="input-api-key" placeholder="Google API Key">
                <button id="save-config-btn" class="btn primary">Initialize API</button>
            </div>
        </section>

        <!-- Auth Step -->
        <section id="auth-section" class="glass-card auth-panel disabled">
            <h2>2. Authentication</h2>
            <div id="login-container" class="login-container">
                <!-- Google Sign-In button will be rendered here dynamically -->
                <div id="google-signin-btn"></div>
            </div>
            <div id="user-profile" class="user-profile hidden">
                <img id="user-avatar" src="" alt="Avatar">
                <span id="user-name"></span>
                <button id="signout-btn" class="btn-text">Sign out</button>
            </div>
        </section>

        <!-- Operations Step -->
        <section id="main-content" class="content-section disabled">
            <h2>3. Spreadsheet Operations</h2>
            <div class="control-panel">
                <div class="glass-card">
                    <h3>Create Spreadsheet</h3>
                    <div class="input-group">
                        <input type="text" id="sheet-title" placeholder="Enter spreadsheet title">
                        <button id="create-sheet-btn" class="btn primary">Create</button>
                    </div>
                </div>

                <div class="glass-card">
                    <h3>Edit Spreadsheet</h3>
                    <div class="input-group">
                        <input type="text" id="spreadsheet-id" placeholder="Spreadsheet ID">
                    </div>
                    <div class="input-group mt-1">
                        <input type="text" id="cell-range" placeholder="Range (e.g. A1)">
                        <input type="text" id="cell-value" placeholder="Value">
                        <button id="update-cell-btn" class="btn secondary">Update</button>
                    </div>
                </div>
            </div>

            <div id="status-display" class="glass-card status-panel">
                <h3>Operation Status</h3>
                <div id="status-log" class="status-log">
                    Please provide configuration above to begin...
                </div>
            </div>
        </section>

        <section id="setup-notice" class="setup-notice">
            <p>Initial setup required: Enter Client ID and API Key, then Sign in.</p>
        </section>
    </main>

    <script src="script.js"></script>
</body>

</html>